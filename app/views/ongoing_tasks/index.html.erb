<% if current_user.id == current_user.coloc.leader_id %>
  <%= link_to "> Gérer la coloc", edit_coloc_path(current_user.coloc), class:"btn-border-purple ml-4" %>
<% end %>

<div class="text-center font-default">
  <h1 class="primary-title">Tach'board</h1>
  <h3 class="secondary-title"><%= current_user.coloc.name %></h3>
</div> 

<%# écran avant 1ère répartition des tâches selon user %>
<% if (current_user.coloc.assignment_day.nil?) && (current_user.id == current_user.coloc.leader_id) %>
  <h3 class="text-center mb-1 font-default text-medium">Tes colocs sont tous là ?</h3>
  <div class="text-center">
    <%= button_to "Créer et distribuer les tâches", start_ongoing_tasks_path, class: "btn-primary" %>
  </div>
  <%= @error %>
<% elsif (current_user.coloc.assignment_day.nil?)%>
  <p>La coloc n'est pas encore au complet, réessaie plus tard !</p>
  <%= link_to "Réessayer", ongoing_tasks_path %>
  
<%# écran après 1ère répartition des tâches %>
<% else %>


  <%# tâches du current user %>
  <div class="my-task-card mb-8">
    <h3 class="secondary-title uppercase">Mes tâches</h3>
    <div class="grid-layout">
      <% @user_tasks.each do |task| %>
        <div>
          <%= render "ongoing_tasks/ongoing_tasks", task: task, assignment: false, validation: true%>
        </div>
      <% end %>    
    </div>
  </div>

  <div class="dashed"></div>
  
  <%# tâches non assignées %>
  <div class="margin-b-64">
    <h3 class="tertiary-title ml-8">Tâches non assignées</h3>
    <div class="grid-5">
      <% @unassigned_tasks.each do |task| %>
        <div class="grid-element">
          <%= render "ongoing_tasks/ongoing_tasks", task: task, assignment: true, validation: false %>
        </div>
      <% end %>
    </div>
  </div>


  <%# tâches des colocs %>
  <div class="my-task-card margin-b-64">
    <% @users_coloc.each do |user| %>
      <div>
        <%= cl_image_tag user.avatar.key, height: 25, width: 25 %>
      </div>
      <div>
        <%= user.username %>
      </div>
      <div class="grid-5">
        <% user.ongoing_tasks.each do |task| %>
          <%= render "ongoing_tasks/ongoing_tasks", task: task, assignment: true, validation: false %>
        <% end %>
      </div>
    <% end %> 
  </div>

  <div>
    <%= link_to "Au revoir !", destroy_user_session_path, method: :delete %>
  </div>
<% end %>
