<%# écran avant 1ère répartition des tâches selon user %>
<% if (current_user.coloc.assignment_day.nil?) && (current_user.id == current_user.coloc.leader_id) %>
  <h3 class="text-center mb-8 text-sm">Avant de continuer,<br>assure toi que le logement soit au complet</h3>
  <div class="text-center">
    <p class="text-base mb-4">On est tous là, c'est parti :</p>
    <%= button_to "Créer et distribuer les tâches", start_ongoing_tasks_path, class: "btn-primary" %>
  </div>
  <%= @error %>
<% elsif (current_user.coloc.assignment_day.nil?)%>
  <p>La coloc n'est pas encore au complet, réessaie plus tard !</p>
  <%= link_to "Réessayer", ongoing_tasks_path %>
  
<%# écran après 1ère répartition des tâches %>
<% else %>
  <% if @user_tasks.all? { |task| task.done }  %>
    <div class="bg-tertiary-100 rounded-xl py-4 px-4 lg:py-6 mx-8 mb-2"> <p class="text-darkGrey-50 text-sm text-center lg:text-xl ">T'as fait toutes tes tâches, bravo ! 🎉</p> </div>
  <% end %>
  <%# tâches du current user %>
  <div class="my-task-card mb-8 lg:mt-10">
    <div class="items-center">
      <h2 class="text-secondary-200 text-base lg:text-xl pr-1 inline-block">Mes tâches de la semaine</h2>
      <%= image_tag 'info.png' , alt: 'info' , class:"hovered_icon info-icon-home inline-block dropdown mb-1"%>
        <p class="info-icon-text hide">
          👉🏻 Voici les tâches que tu dois faire cette semaine. Elles ne peuvent être validées qu'une seule fois.
        </p>
    </div>
    <div class="task_grid mt-4 lg:mt-8">
      <% @user_tasks.each do |task| %>
        <div class="flex flex-col items-center justify-between mb-4">
          <%= render "ongoing_tasks/ongoing_tasks", task: task, assignment: false, validation: true%>
        </div>
      <% end %> 
    </div>
  </div>

  <div class="dashed lg:mt-16"></div>
  
  <%# tâches non assignées %>
  <div class="bonus-task-card mb-8">
    <div class="items-center">
      <h2 class="text-primary-200 text-base lg:text-xl pr-1 inline-block">Tâches bonus</h2>
      <%= image_tag 'info.png' , alt: 'info' , class:"hovered_icon info-icon-home inline-block dropdown mb-1"%>
      <p class="info-icon-text hide">
        👉🏻 Les tâches bonus peuvent être réalisées plusieurs fois dans la semaine et par n'importe qui.
      </p>
    </div>
    
    <div class="task_grid mt-4 lg:mt-8 gap-4">
      <% @unassigned_tasks.each do |task| %>
        <div class="flex flex-col items-center justify-between bg-offwhite-200 rounded-xl p-4">
          <%= render "ongoing_tasks/ongoing_tasks", task: task, assignment: true, validation: false %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="w-full bg-secondary-200 h-16 lg:h-32 lg:mt-16 lg:mb-16 text-white flex justify-center items-center text-xl mb-8 font-default lg:text-2xl"> <%= @current_user.coloc.name %> </div>

  <%# tâches des colocs %>
  <div class="coloc-task-card">
    <div class="items-center">
      <h2 class="text-secondary-200 text-base lg:text-xl pr-1 inline-block">Les tâches de tes colocs</h2>
      <%= image_tag 'info.png' , alt: 'info' , class:"hovered_icon info-icon-home inline-block dropdown mb-1"%>
        <p class="info-icon-text hide">
          👉🏻 Retrouve les tâches de tes colocs' et suit leurs avancées.
        </p>
    </div>
    <div>
      <% @users_coloc.each do |user| %>
        <div class="coloc-avatar-name">

          <div class="dashed mt-0"></div>

          <div>
            <%= cl_image_tag user.avatar.key, height: 80, width: 80, class:"pr-2 rounded-full" %>
          </div>

          <div class="mt-2 uppercase text-secondary-200">
            <%= user.username %>
          </div>

          <div class="carrot_price_circle mb-4">
            <%= image_tag 'carrot_icon.png' , alt: 'carrot_price' , class:"w-4 h-6 pr-1" %>
            <p class="text-base"><%= user.current_points %></p> 
          </div>

        </div>
        <div class="task_grid">
          <% user.ongoing_tasks.each do |task| %>
          <div class="flex flex-col items-center justify-between">
            <%= render "ongoing_tasks/ongoing_tasks", task: task, assignment: true, validation: false %>
          </div>
          <% end %>
        </div>
      <% end %> 
    </div>
  </div>
  
  <div class="flex justify-around items-center my-8 text-sm lg:text-base lg:my-16">
    <div>
      <% if current_user.id == current_user.coloc.leader_id %>
        <%= link_to "> Gérer la coloc", edit_coloc_path(current_user.coloc), class:"btn-border-purple" %>
      <% end %>
    </div>
    <div>
      <%= link_to "Se déconnecter", destroy_user_session_path, method: :delete %>
    </div>
  <% end %>
  </div>
