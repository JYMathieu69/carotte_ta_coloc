<%# Ã©cran avant 1Ã¨re rÃ©partition des tÃ¢ches selon user %>
<% if (current_user.coloc.assignment_day.nil?) && (current_user.id == current_user.coloc.leader_id) %>
  <h3 class="text-center mb-8 text-sm">Avant de continuer,<br>assure toi que le logement soit au complet</h3>
  <div class="text-center">
    <p class="text-base mb-4">On est tous lÃ , c'est parti :</p>
    <%= button_to "CrÃ©er et distribuer les tÃ¢ches", start_ongoing_tasks_path, class: "btn-primary" %>
  </div>
  <%= @error %>
<% elsif (current_user.coloc.assignment_day.nil?)%>
  <p>La coloc n'est pas encore au complet, rÃ©essaie plus tard !</p>
  <%= link_to "RÃ©essayer", ongoing_tasks_path %>
  
<%# Ã©cran aprÃ¨s 1Ã¨re rÃ©partition des tÃ¢ches %>
<% else %>
  <% if @user_tasks.all? { |task| task.done }  %>
    <div class="bg-tertiary-100 rounded-xl py-4 px-4 lg:py-6 mx-8 mb-2"> <p class="text-darkGrey-50 text-sm text-center lg:text-xl ">T'as fait toutes tes tÃ¢ches, bravo ! ğŸ‰</p> </div>
  <% end %>
  <%# tÃ¢ches du current user %>
  <div class="my-task-card mb-8">
    <div class="dropdown">
      <div class="flex items-center">
        <h2 class="text-secondary-200 text-base lg:text-xl pr-2">Mes tÃ¢ches de la semaine</h2>
        <%= image_tag 'info.png' , alt: 'info' , class:"hovered_icon info-icon-home"%>
      </div>
      <div class="info-icon-text hide h-12">ğŸ‘‰ğŸ» Voici les tÃ¢ches que tu dois faire cette semaine !</div>
    </div>
    <div class="grid-layout">
      <% @user_tasks.each do |task| %>
        <div>
          <%= render "ongoing_tasks/ongoing_tasks", task: task, assignment: false, validation: true%>
        </div>
      <% end %> 
    </div>
  </div>
  
  <%# tÃ¢ches non assignÃ©es %>
  <div class="my-task-card mb-8">
      <div class="dropdown">
        <div class="flex items-center">
          <h2 class="text-tertiary-200 text-base lg:text-xl pr-2">TÃ¢ches bonus</h2>
          <%= image_tag 'info.png' , alt: 'info' , class:"hovered_icon info-icon-home"%>
        </div>
        <div class="info-icon-text hide h-12">ğŸ‘‰ğŸ» Les tÃ¢ches bonus peuvent Ãªtre rÃ©alisÃ©es plusieurs fois dans la semaine et par n'importe qui !</div>
      </div>
    <div class="grid-layout">
      <% @unassigned_tasks.each do |task| %>
        <div>
          <%= render "ongoing_tasks/ongoing_tasks", task: task, assignment: true, validation: false %>
        </div>
      <% end %>
    </div>
  </div>

  <%# tÃ¢ches des colocs %>
  <div class="my-task-card mb-12 ml-8">

    <h3 class="tertiary-title text-darkGrey-50"><%= current_user.coloc.name %></h3>
    <% @users_coloc.each do |user| %>
      <div class="coloc-avatar-name">
        <div>
          <%= cl_image_tag user.avatar.key, height: 80, width: 80, class:"pr-2 rounded-full" %>
        </div>
      
        <div class="mt-2 uppercase">
          <%= user.username %>
        </div>
      </div>
      <div class="grid-layout">
        <% user.ongoing_tasks.each do |task| %>
        <div>
          <%= render "ongoing_tasks/ongoing_tasks", task: task, assignment: true, validation: false %>
        </div>
        <% end %>
      </div>
    <% end %> 
  </div>

  <div>
    <%= link_to "Se dÃ©connecter", destroy_user_session_path, method: :delete %>
  </div>
  <div>
    <% if current_user.id == current_user.coloc.leader_id %>
      <%= link_to "> GÃ©rer la coloc", edit_coloc_path(current_user.coloc), class:"btn-border-purple ml-8" %>
    <% end %>
  </div>
<% end %>
